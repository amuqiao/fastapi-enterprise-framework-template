# å‚è€ƒæ–‡æ¡£

- [**Python åŒ…ç®¡ç†å·¥å…· uv ä½¿ç”¨æ•™ç¨‹**](https://zhuanlan.zhihu.com/p/1888904532131575259)
- [**ä½¿ç”¨ uv ç®¡ç† Python ç’°å¢ƒ**](https://dev.to/codemee/shi-yong-uv-guan-li-python-huan-jing-53hg)
- [PythonåŒ…ç®¡ç†ä¸å†å¤´ç–¼ï¼šuvå·¥å…·å¿«é€Ÿä¸Šæ‰‹](https://www.cnblogs.com/wang_yb/p/18635441)
- [uvä¸­æ–‡ä½¿ç”¨æ–‡æ¡£](https://hellowac.github.io/uv-zh-cn/)

# å…³äº uv å·¥å…·çš„è§£é‡Š

**uv** æ˜¯æ–°ä¸€ä»£é«˜æ€§èƒ½ Python åŒ…ç®¡ç†å·¥å…·ï¼Œç”± Astral å›¢é˜Ÿï¼ˆåŒå± Pylance å’Œ Ruff å›¢é˜Ÿï¼‰å¼€å‘ã€‚

# ä¸ `conda`/`venv` çš„åŒºåˆ«

1. **åŠŸèƒ½å®šä½**
    - `venv`ï¼šPython åŸç”Ÿçš„è™šæ‹Ÿç¯å¢ƒç®¡ç†
    - `conda`ï¼šè·¨è¯­è¨€çš„åŒ…å’Œç¯å¢ƒç®¡ç†
    - `uv`ï¼šä¸“æ³¨äº Python ä¾èµ–å®‰è£…å’Œè§£æï¼ˆéœ€é…åˆè™šæ‹Ÿç¯å¢ƒä½¿ç”¨ï¼‰
2. **æ€§èƒ½ä¼˜åŠ¿**
    - æ¯” `pip` å¿« 10-100 å€
    - æ”¯æŒå¹¶è¡Œä¾èµ–è§£æ
    - è‡ªå¸¦ç¼“å­˜æœºåˆ¶
3. **å…¼å®¹æ€§**
    - å…¼å®¹ `pip` å’Œ `pip-tools` çš„å·¥ä½œæµ
    - æ”¯æŒ `requirements.txt`å’Œ`pyproject.toml`

# å®‰è£…æ–¹æ³•

```bash
**# é€šè¿‡ pip å®‰è£…**
pip install uv

# **Homebrew å®‰è£…ï¼ˆä»…macOSï¼‰**
brew install uv

**# On macOS and Linux.**
curl -LsSf <https://astral.sh/uv/install.sh> | sh

**# On Windows.**
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
```

- å®‰è£…ä¹‹åï¼Œå¯ä»¥é€šè¿‡`uv help`å‘½ä»¤æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ

```bash
(.venv) âœ  test git:(main) uv help
An extremely fast Python package manager.

Usage: uv [OPTIONS] <COMMAND>

Commands:
  run                        Run a command or script
  init                       Create a new project
  add                        Add dependencies to the project
  remove                     Remove dependencies from the project
  sync                       Update the project's environment
  lock                       Update the project's lockfile
  export                     Export the project's lockfile to an alternate format
  tree                       Display the project's dependency tree
  tool                       Run and install commands provided by Python packages
  python                     Manage Python versions and installations
  pip                        Manage Python packages with a pip-compatible interface
  venv                       Create a virtual environment
  build                      Build Python packages into source distributions and wheels
  publish                    Upload distributions to an index
  cache                      Manage uv's cache
  self                       Manage the uv executable
  version                    Display uv's version
  generate-shell-completion  Generate shell completion
  help                       Display documentation for a command
```

# å¸¸ç”¨å‘½ä»¤

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
uv venv .venv

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ æŒ‡å®špythonç‰ˆæœ¬
uv venv .venv --python=3.12

# å®‰è£…ä¾èµ–ï¼ˆæ›¿ä»£ pipï¼‰
uv pip install -r requirements.txt

# å®‰è£…æŒ‡å®šåŒ…
uv pip install requests

# æŸ¥çœ‹å·²ç»å®‰è£…çš„åŒ…ï¼Œæ³¨æ„è·Ÿpip list çš„åŒºåˆ«
uv pip list

# æŸ¥çœ‹å·²ç»å®‰è£…çš„pythonç‰ˆæœ¬
uv python list

# æŸ¥çœ‹pythonå®‰è£…è·¯å¾„
uv python dir

# æŸ¥çœ‹ä¾èµ–å…³ç³»
uv pip tree

# æŸ¥çœ‹Pythonè§£é‡Šå™¨è·¯å¾„
which python  
 
```

- æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

```python
# Linux/macOS
source .venv/bin/activate

# Windowsï¼ˆPowerShellï¼‰
.venv\Scripts\Activate.ps1
```

- é€€å‡ºè™šæ‹Ÿç¯å¢ƒ

```python
deactivate
```

<aside>
ğŸ’¡

æ³¨æ„äº‹é¡¹ ï¼š

1. ä½¿ç”¨å‰ç¡®ä¿å·²å®‰è£…uvï¼š `pip install uv`
2. æ¿€æ´»åç»ˆç«¯æç¤ºç¬¦ä¼šæ˜¾ç¤ºç¯å¢ƒåç§°ï¼ˆå¦‚ï¼š `(.venv) user@host` ï¼‰
3. å»ºè®®åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ“ä½œ
4. ä¸è¦ä¸`conda`ç¯å¢ƒæ··ç”¨ï¼Œä½¿ç”¨å‰å…ˆæ‰§è¡Œ `conda deactivate`
</aside>

# åˆå§‹åŒ–é¡¹ç›®

```bash
# ç”Ÿæˆpyproject.tomlã€uv.lockç­‰æ–‡ä»¶,myprojectæ˜¯é¡¹ç›®åç§°
uv init <project dir>
uv init myproject
uv init test_uv
```

# æ ¸å¿ƒä½¿ç”¨åœºæ™¯

- **åˆå§‹åŒ–é¡¹ç›®**

è‡ªåŠ¨ç”Ÿæˆé¡¹ç›®ç»“æ„ï¼Œå¹¶æ”¯æŒGitç®¡ç†

```bash
uv init myproject  
# ç”Ÿæˆpyproject.tomlã€uv.lockã€.gitginoreã€.python-versionã€main.pyã€
# README.md æ–‡ä»¶
cd myproject
uv sync            # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–
```

- **ä¾èµ–ç®¡ç†**
    - æ·»åŠ ä¾èµ–ï¼š`uv add pandas`ï¼ˆè‡ªåŠ¨æ›´æ–°`pyproject.toml`å’Œ`uv.lock`ï¼‰
    - åˆ é™¤ä¾èµ–ï¼š`uv remove pandas`ï¼ˆè¿å¸¦æ¸…ç†å­ä¾èµ–ï¼‰
    - ç¯å¢ƒåŒæ­¥ï¼š`uv sync` ç¡®ä¿è™šæ‹Ÿç¯å¢ƒä¸é”æ–‡ä»¶ä¸€è‡´
- **è·¨Pythonç‰ˆæœ¬æ”¯æŒ**
    
    ```bash
    uv venv --python 3.10  # æŒ‡å®šPythonç‰ˆæœ¬ï¼ˆéœ€å·²å®‰è£…ï¼‰
    uv run --python 3.10 main.py
    ```
    
    æ”¯æŒé’ˆå¯¹ä¸åŒç‰ˆæœ¬ç”Ÿæˆä¾èµ–è§£æ[718](https://www.notion.so/@ref)ã€‚
    
- **å¿«é€Ÿè¿è¡Œè„šæœ¬**
    
    ```bash
    uv run main.py  # è‡ªåŠ¨æ£€æµ‹è™šæ‹Ÿç¯å¢ƒå¹¶æ‰§è¡Œ
    ```
    
    æ›¿ä»£ä¼ ç»Ÿ`python main.py`ï¼Œç®€åŒ–å¼€å‘æµç¨‹
    

**æ¨èå·¥ä½œæµ**

1. **æœ¬åœ°å¼€å‘**ï¼š
    - ä½¿ç”¨uvç®¡ç†ä¾èµ–å’Œè™šæ‹Ÿç¯å¢ƒï¼Œç»“åˆ`pyproject.toml`å®šä¹‰é¡¹ç›®å…ƒæ•°æ®ã€‚
    - ç”Ÿäº§ç¯å¢ƒé€šè¿‡`uv.lock`ç¡®ä¿ä¾èµ–ä¸€è‡´æ€§
2. **ä¸Condaå…±å­˜**ï¼š
    - æ•°æ®ç§‘å­¦åœºæ™¯ï¼šç”¨Condaç®¡ç†Pythonè§£é‡Šå™¨å’ŒéPythonåº“ï¼Œuvç®¡ç†Pythonä¾èµ–
    - ç¤ºä¾‹ï¼š
    
    ```bash
    conda create -n data_env python=3.12
    conda activate data_env
    uv pip install numpy pandas  # ä½¿ç”¨uvåŠ é€Ÿå®‰è£…
    ```
    

# ä½¿ç”¨ç¤ºä¾‹

```bash
âœ  test git:(main) uv venv .venv --python=3.12
Using CPython 3.12.7 interpreter at: /opt/anaconda3/bin/python3.12
Creating virtual environment at: .venv
Activate with: source .venv/bin/activate
âœ  test git:(main) 
âœ  test git:(main) source .venv/bin/activate

(.venv) âœ  test git:(main) which python
/Users/wangqiao/NutstoreFiles/code/ai/my_dify_project/my_dify/test/.venv/bin/python

(.venv) âœ  servo_ai_project uv init servo_ai 
Initialized project `servo-ai` at `/Users/wangqiao/NutstoreFiles/code/ai/servo_ai_project/servo_ai`

(.venv) âœ  test git:(main) uv pip install requests
Resolved 5 packages in 5.90s
Prepared 5 packages in 1.65s
Installed 5 packages in 22ms
 + certifi==2025.1.31
 + charset-normalizer==3.4.1
 + idna==3.10
 + requests==2.32.3
 + urllib3==2.4.0
(.venv) âœ  test git:(main) uv pip list
Package            Version
------------------ ---------
certifi            2025.1.31
charset-normalizer 3.4.1
idna               3.10
requests           2.32.3
urllib3            2.4.0
```

# ä¸ pip list çš„åŒºåˆ«

1. **åº•å±‚æœºåˆ¶**
    - `uv pip list`ï¼šé€šè¿‡ uv è‡ªå¸¦çš„åŒ…ç®¡ç†å™¨è¯»å–ç¯å¢ƒå…ƒæ•°æ®
    - `pip list`ï¼šè°ƒç”¨ä¼ ç»Ÿ pip å·¥å…·è§£æç¯å¢ƒ
2. **æ€§èƒ½è¡¨ç°**
    - uv çš„åŒ…åˆ—è¡¨æŸ¥è¯¢é€Ÿåº¦æ¯” pip å¿« 5-10 å€
    - å¤„ç†å¤§å‹ä¾èµ–æ ‘æ—¶å·®å¼‚æ›´æ˜æ˜¾
3. **åŠŸèƒ½ç‰¹æ€§**
    - uv æ”¯æŒè·¨å¹³å°ç¼“å­˜å¤ç”¨
    - pip éœ€è¦é…åˆ virtualenv/venv ä½¿ç”¨
4. **ç¯å¢ƒéš”ç¦»**
    - ä¸¤è€…æ˜¾ç¤ºçš„éƒ½æ˜¯å½“å‰æ¿€æ´»ç¯å¢ƒçš„åŒ…åˆ—è¡¨
    - éœ€è¦å…ˆç¡®è®¤æ¿€æ´»çš„æ˜¯ç›®æ ‡ uv è™šæ‹Ÿç¯å¢ƒ

# uv è™šæ‹Ÿç¯å¢ƒä¾èµ–ç®¡ç†è¯´æ˜

1. ç¯å¢ƒéš”ç¦»æœºåˆ¶ uv åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒä¸ `Conda` ç¯å¢ƒå®Œå…¨ç‹¬ç«‹ï¼Œ `uv pip list` åªæ˜¾ç¤ºå½“å‰æ¿€æ´»ç¯å¢ƒçš„åŒ…ã€‚
2. ä¾èµ–å®‰è£…å·®å¼‚ `uv venv .venv` åˆ›å»ºçš„æ˜¯ç©ºç¯å¢ƒï¼Œä¸ä¼šè‡ªåŠ¨å®‰è£…ä»»ä½•åŒ…ï¼Œéœ€æ‰‹åŠ¨æ‰§è¡Œ `uv pip install -r requirements.txt` å®‰è£…ä¾èµ–
3. Conda ç¯å¢ƒå¹²æ‰°é—®é¢˜ åœ¨ Conda ç¯å¢ƒä¸­åˆ›å»º uv è™šæ‹Ÿç¯å¢ƒæ—¶ï¼š

```bash
# æ­£ç¡®æµç¨‹
conda deactivate         # é€€å‡º Conda ç¯å¢ƒ
uv venv .venv           # åˆ›å»ºçº¯å‡€è™šæ‹Ÿç¯å¢ƒ
source .venv/bin/activate # æ¿€æ´» uv ç¯å¢ƒ
uv pip install package  # å®‰è£…æ‰€éœ€ä¾èµ–
```

éªŒè¯å½“å‰ç¯å¢ƒ æ‰§è¡Œ `which python` ç¡®è®¤ `Python` è§£é‡Šå™¨è·¯å¾„æ˜¯å¦æŒ‡å‘ `.venv` ç›®å½•

# æ ¹æ®`pyproject.toml` å®‰è£…é¡¹ç›®ä¾èµ–

- å°†pyproject.tomlä¸­çš„redisä¾èµ–ç‰ˆæœ¬ä»>=5.2.1æ›´æ–°è‡³==3.5.3

```sql
dependencies = [
    ...
    "redis==3.5.3",
    ...
]

[tool.uv]
dev-dependencies = [
    ...
    "redis==3.5.3",
    ...
]
```

```sql
# è¿›å…¥é¡¹ç›®ç›®å½•ï¼ˆå¦‚æœæœªåœ¨é¡¹ç›®æ ¹ç›®å½•ï¼‰
# å®‰è£…é¡¹ç›®ä¾èµ–
uv pip install -e .
```

# uvé›†æˆdocker

- [**åœ¨ Docker ä¸­ä½¿ç”¨ uv**](https://hellowac.github.io/uv-zh-cn/guides/integration/docker/#docker-uv)